<?xml version="1.0" encoding="utf-8"?>
<project xmlns="http://www.plcopen.org/xml/tc6_0200">
    <fileHeader companyName="Beckhoff Automation GmbH" productName="TwinCAT PLC Control" productVersion="3.5.20.50" creationDateTime="2025-07-01T11:02:16.1300929" />
    <contentHeader name="testproj" modificationDateTime="2025-07-01T11:02:16.1300929">
        <coordinateInfo>
        <fbd>
            <scaling x="1" y="1" />
        </fbd>
        <ld>
            <scaling x="1" y="1" />
        </ld>
        <sfc>
            <scaling x="1" y="1" />
        </sfc>
        </coordinateInfo>
        <addData>
        <data name="http://www.3s-software.com/plcopenxml/projectinformation" handleUnknown="implementation">
            <ProjectInformation />
        </data>
        </addData>
    </contentHeader>
    <types>
        <dataTypes />
        <pous />
    </types>
    <instances>
        <configurations />
    </instances>
    <addData>
        <data name="http://www.3s-software.com/plcopenxml/application" handleUnknown="implementation">
        <resource name="testproj">
            <addData>
            <data name="http://www.3s-software.com/plcopenxml/pou" handleUnknown="implementation">
                <pou name="MonBinVlv" pouType="functionBlock">
    <interface>
        <inputVars>
            <variable name="StateChannel">
                <type>
                    <BOOL />
                </type>
            </variable>
            <variable name="StateOffAut">
                <type>
                    <BOOL />
                </type>
            </variable>
            <variable name="StateOpAut">
                <type>
                    <BOOL />
                </type>
            </variable>
            <variable name="StateAutAut">
                <type>
                    <BOOL />
                </type>
            </variable>
            <variable name="PermEn">
                <type>
                    <BOOL />
                </type>
            </variable>
            <variable name="IntlEn">
                <type>
                    <BOOL />
                </type>
            </variable>
            <variable name="ProtEn">
                <type>
                    <BOOL />
                </type>
            </variable>
            <variable name="Permit">
                <type>
                    <BOOL />
                </type>
            </variable>
            <variable name="Interlock">
                <type>
                    <BOOL />
                </type>
            </variable>
            <variable name="Protect">
                <type>
                    <BOOL />
                </type>
            </variable>
            <variable name="WQC">
                <type>
                    <BYTE />
                </type>
            </variable>
            <variable name="SafePos">
                <type>
                    <BOOL />
                </type>
            </variable>
            <variable name="OpenAut">
                <type>
                    <BOOL />
                </type>
            </variable>
            <variable name="CloseAut">
                <type>
                    <BOOL />
                </type>
            </variable>
            <variable name="OpenFbkCalc">
                <type>
                    <BOOL />
                </type>
            </variable>
            <variable name="CloseFbkCalc">
                <type>
                    <BOOL />
                </type>
            </variable>
            <variable name="OpenFbk">
                <type>
                    <BOOL />
                </type>
            </variable>
            <variable name="CloseFbk">
                <type>
                    <BOOL />
                </type>
            </variable>
            <variable name="MonSafePos">
                <type>
                    <BOOL />
                </type>
            </variable>
            <variable name="MonStatTi">
                <type>
                    <REAL />
                </type>
            </variable>
            <variable name="MonDynTi">
                <type>
                    <REAL />
                </type>
            </variable>
            <variable name="ResetAut">
                <type>
                    <BOOL />
                </type>
            </variable>
        </inputVars>
        <outputVars>
            <variable name="StateOpAct">
                <type>
                    <BOOL />
                </type>
            </variable>
            <variable name="StateAutAct">
                <type>
                    <BOOL />
                </type>
            </variable>
            <variable name="StateOffAct">
                <type>
                    <BOOL />
                </type>
            </variable>
            <variable name="SafePosAct">
                <type>
                    <BOOL />
                </type>
            </variable>
            <variable name="Ctrl">
                <type>
                    <BOOL />
                </type>
            </variable>
            <variable name="MonStatErr">
                <type>
                    <BOOL />
                </type>
            </variable>
            <variable name="MonDynErr">
                <type>
                    <BOOL />
                </type>
            </variable>
            <variable name="OperationMode">
                <type>
                    <INT />
                </type>
            </variable>
        </outputVars>
        <localVars>
            <variable name="StateOffOp">
                <type>
                    <BOOL />
                </type>
            </variable>
            <variable name="StateOpOp">
                <type>
                    <BOOL />
                </type>
            </variable>
            <variable name="StateAutOp">
                <type>
                    <BOOL />
                </type>
            </variable>
            <variable name="OpenOp">
                <type>
                    <BOOL />
                </type>
            </variable>
            <variable name="CloseOp">
                <type>
                    <BOOL />
                </type>
            </variable>
            <variable name="ResetOp">
                <type>
                    <BOOL />
                </type>
            </variable>
            <variable name="MonEn">
                <type>
                    <BOOL />
                </type>
            </variable>
            <variable name="OpenedState">
                <type>
                    <BOOL />
                </type>
            </variable>
            <variable name="ClosedState">
                <type>
                    <BOOL />
                </type>
            </variable>
            <variable name="DelayTimer1">
                <type>
                    <derived name="TON" />
                </type>
            </variable>
            <variable name="DelayTimer2">
                <type>
                    <derived name="TON" />
                </type>
            </variable>
        </localVars>
    </interface>
    <body>
        <ST>
            <xhtml xmlns="http://www.w3.org/1999/xhtml">
// State Machine for the OperationMode
// Make boolean indicators for the OperationMode State
StateOpAct := OperationMode = 1;
StateAutAct := OperationMode = 2;
StateOffAct := OperationMode = 0;
// 'Protect' is for interlocks that need to be reset
IF ProtectSource THEN
    Protect := TRUE;
ELSIF (ResetAut AND StateChannel) OR (ResetOp AND NOT StateChannel) THEN
    Protect := FALSE;
END_IF;
SafePosAct := (PermEn AND NOT Permit) OR (IntlEn AND NOT Interlock) OR (ProtEn AND NOT Protect) OR (MonEn AND (MonStatErr OR MonDynErr));
IF (SafePosAct AND SafePos AND NOT SafePosEn) OR (NOT SafePosAct AND ((OpenAut AND StateAutAct) OR (OpenOp and StateOpAct))) THEN
    Ctrl := TRUE;
ELSIF (SafePosAct AND NOT SafePos NOT SafePosEn) OR (NOT SafePosAct AND ((CloseAut AND StateAutAct) OR (CloseOp and StateOpAct))) THEN
    Ctrl := FALSE;
END_IF;
IF (MonEn AND OpenedState AND NOT OpenFbk) OR ( MonEn AND ClosedState AND NOT CloseFbk) THEN
    MonStatErr := TRUE;
ELSIF (ResetAut AND StateChannel) OR (ResetOp AND NOT StateChannel) THEN
    MonStatErr := FALSE;
END_IF;
IF MonEn AND ((Ctrl AND NOT OpenFbk) OR (NOT Ctrl AND NOT ClsFbk)) THEN
    MonDynErr := TRUE;
ELSIF (ResetAut AND StateChannel) OR (ResetOp AND NOT StateChannel) THEN
    MonDynErr := FALSE;
END_IF;
IF Ctrl AND OpenFbk THEN
    OpenedState := TRUE;
ELSIF NOT Ctrl THEN
    OpenedState := FALSE;
END_IF;
IF NOT Ctrl AND CloseFbk THEN
    ClosedState := TRUE;
ELSIF Ctrl THEN
    ClosedState := FALSE;
END_IF;
StateOffOp := False;
StateOpOp := False;
StateAutOp := False;
OpenOp := False;
CloseOp := False;
ResetOp := False;
            </xhtml>
        </ST>
    </body>
</pou>                             </data>
            </addData>
        </resource>
        </data>
        <data name="http://www.3s-software.com/plcopenxml/projectstructure" handleUnknown="discard">
        <ProjectStructure>
            <Object Name="project_name_does_not_matter">
            </Object>
        </ProjectStructure>
        </data>
    </addData>
</project>